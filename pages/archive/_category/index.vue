<template>
  <Category :articles="articles" :category="category" />
</template>
<script>
const formatDate = function(date) {
  const options = { year: "numeric", month: "long", day: "numeric" };
  return new Date(date).toLocaleDateString("en", options);
};
export default {
  layout: "detail",
  async asyncData({ $content, params }) {
    const category = params.category;
    let articles = [];
    try {
      articles = (
        await $content("articles", category)
          .without("body")
          .sortBy("createdAt", "asc")
          .fetch()
      ).map(article => {
        let extendedArticle = article;
        extendedArticle.createdAt = formatDate(article.createdAt);
        extendedArticle.updatedAt = formatDate(article.updatedAt);
        return extendedArticle;
      });
    } catch (error) {
      articles = [];
    }
    return {
      articles,
      category
    };
  },
  data: () => ({}),
  content: {
    nestedProperties: ["category.name"]
  },

  watch: {},
  mounted() {}
};
</script>
